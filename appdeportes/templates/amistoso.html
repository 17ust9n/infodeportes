{% extends 'base.html' %}
{% load static %}

{% block title %}Partido Amistoso{% endblock %}

{% block content %}
<header>
  <h2 class="titulo">Partido Amistoso ⚽</h2>
</header>

<main style="max-width: 800px; margin: auto; padding: 20px;">

  <!-- FORMULARIO PARA JUGAR -->
  <form method="post" style="display: flex; flex-direction: column; gap: 15px;">
      {% csrf_token %}

      <div>
          <label for="equipo_vos"><strong>Tu Equipo:</strong></label>
          <select name="equipo_vos" id="equipo_vos" required style="padding: 5px; width: 100%;">
              <option value="" disabled selected>Elige tu equipo</option>
              {% for equipo in equipos %}
                  <option value="{{ equipo.id }}"
                      {% if equipo_vos and equipo.id == equipo_vos.id %}selected{% endif %}>
                      {{ equipo.nombre }}
                  </option>
              {% endfor %}
          </select>
      </div>

      <div>
          <label for="goles_vos"><strong>Goles que marcaste:</strong></label>
          <input type="number" name="goles_vos" id="goles_vos" min="0"
                 value="{{ goles_vos|default:0 }}" required style="padding: 5px; width: 100%;">
      </div>

      <button type="submit" style="padding:10px; background:#28a745; color:white; border:none; border-radius:5px;">
          Jugar
      </button>
  </form>

  {% if resultado %}
  <hr style="margin: 20px 0;">
  <h2>Resultado del Partido:</h2>

  <div class="recuadro-resultado">
      <p class="marcador">
          <strong>{{ equipo_vos.nombre }}</strong> {{ goles_vos }} (VOS)
          &nbsp; - &nbsp;
          {{ goles_pc }} (PC) <strong>{{ equipo_pc.nombre }}</strong>
      </p>

      <p class="resultado">{{ resultado }}</p>

      <!-- Botón para reiniciar -->
      <form method="get" action="{% url 'amistoso' %}">
          <button type="submit" class="boton">Reiniciar</button>
      </form>

      <!-- Botón para guardar el partido -->
      {% if not guardado %}
      <form method="post" action="{% url 'guardar_partido' %}">
          {% csrf_token %}
          <input type="hidden" name="equipo_vos_id" value="{{ equipo_vos.id }}">
          <input type="hidden" name="equipo_pc_id" value="{{ equipo_pc.id }}">
          <input type="hidden" name="goles_vos" value="{{ goles_vos }}">
          <input type="hidden" name="goles_pc" value="{{ goles_pc }}">
          <input type="hidden" name="resultado" value="{{ resultado }}">
          <button type="submit" class="boton">Guardar Partida</button>
      </form>
      {% else %}
          <p>✅ Partida guardada.</p>
      {% endif %}

    <form method="get" action="{% url 'lista_partidos' %}" style="margin-top:10px;">
        <button type="submit" class="boton" style="background:#007bff;">Ver Historial</button>
    </form>

  </div>
{% endif %}


</main>
{% endblock %}
